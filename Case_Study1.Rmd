---
title: "A study of top beers in America"
author: "Paul Marquardt, Chris Ballenger, and Bhuvana Adur Kannan"
date: "June 17, 2018"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(plyr)
library(ggplot2)
library(kableExtra)
library(dataMaid)
```

### MSDS 6306: Case Study 1 Introduction
The following document represents a case study of craft breweries and the beers they produce across the United States. In this study we will make some general observations with the hope of providing information concerning details of the craft brewery market in the United States. This study does not represent an exhaustive list of craft breweries and their beers, but does contain general information about the overall craft beer market.Craft breweries are growing across the nation, as we can see in the following table.

Table 1: Contains a total count of the number of breweries by their respective state
```{r}
# Question 1. How many breweries are present in each state?
# Read the breweries.csv into a dataframe and assign the variable name brew
brew <- read.csv(file = "breweries.csv", header = TRUE, sep = ",", strip.white = TRUE)
# Assign the count function against the State column to the variable name st
st <- count(brew, "State")
# Display the st variable output
kable( st )  %>%
  kable_styling(bootstrap_options = c("striped", "condensed"), full_width = F)
```

There are numerous different types of beer styles. Each style of beer is created using differnt types of ingredients which include barley, malt, hops, and yeast. This also includes cider and lambic which is made from fruit juice. 

Table 2: Lists several different styles of beer and corresponding data including hard cider
```{r}
# Question 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file. 
# Read the beers.csv and assign it to the beer variable
beer <- read.csv(file = "beers.csv", header = TRUE, sep = ",", strip.white = TRUE)
# Merge the beers and brew data frames into the brewbeer variable
brewbeer <- merge(brew, beer, by.x = "Brew_ID", by.y="Brewery_id")
# Update Column Names
names(brewbeer) <- c('Beer_ID','Brewery','City','State','Beer','Beer_ID','ABV','IBU','Style','Ounces')
# Display the first 6 lines of the merged dataset
kable( head(brewbeer) ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"))
# Display the last 6 lines of the merged dataset
kable( tail(brewbeer) ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"))
``` 

Table 3: List of missing values in each column
```{r}
# Question 3. Report the number of NA's in each column.
# Use sapply to count how many NAs are in each column
dt <- sapply( brewbeer, function(y) sum( length( which( is.na( y ) ) ) ) )
kable(dt) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"))
``` 
Analyzing the data, we have a large gap in IBU's of 1005 missing values out of 2410 rows.  There is also missing values in ABV, but small enough to continue with our analysis.

```{r}
# Question 4. Compute the median alcohol content and international bitterness
# aggregate function to get the median value for ABV and IBU
# we are ignoring any NA values for the purpose of this study.
median_abv_ibu <- aggregate( brewbeer[ , 7:8 ], list( brewbeer$State ), median, na.rm=TRUE )
names(median_abv_ibu) <- c('State','ABV','IBU')
``` 

Table 4.1: Median ABV by State
```{r fig.height=10}
# Add Labels
ggplot( median_abv_ibu[!is.na(median_abv_ibu$IBU),], aes( State, ABV ) ) +
    geom_bar(stat="identity") +
    labs(title="Alcohol by Volume By State",x ="Alcohol by Volume", y = "State") +
    coord_flip()
```

The chart shows us that the District of Columbia had the highest median Alcohol by Volume (ABV) at 6.25% and Utah had the lowest at 4%.

Table 4.2: Median IBU by State
```{r fig.height=10}
# Add Labels
ggplot( median_abv_ibu[!is.na(median_abv_ibu$IBU),] , aes( State, IBU ) ) +
    geom_bar(stat="identity") +
    labs(title="International Bittering Unit By State",x ="International Bittering Unit", y = "State") +
    coord_flip()
```

Maine has the highest median International Bittering Unit (IBU) of 61, while Hawaii has the lowest at 22.5 IBUs.

Table 5.1: Highest Rated Alcoholic Beer
```{r}
# Question 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer? 
# Order by ABV to get the top state
kable( head( brewbeer[order(brewbeer$ABV, decreasing=TRUE),c(4,2,5,7,9) ], 1) ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"))
```

We show that Colorodo brewing company, Upslope Brewing Company, has the highest alcoholic beer at 12.8%.

Table 5.2: Highest Rated Bitterest Beer
```{r}
# Order by IBU to get the top state
kable( head( brewbeer[order(brewbeer$IBU, decreasing=TRUE),c(4,2,5,8,9) ], 1) ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"))
``` 

We show that Oregon has the highest IBU beer, which is an American Double / Imperial IPA.

Table 6.1: Summary statistics for the ABV variable. 
```{r}
kable(data.frame(Summary_Statistics_Value = unclass(summary(brewbeer$ABV))))%>%
  kable_styling(bootstrap_options = c("striped", "condensed"), full_width = F)
``` 
The summary shows that the mean is slightly higher than the median, which means that the distribution of the ABV variable will be right skewed.

Table 7.1 : Scatter plot to show the relationship between the bitterness of the beer and its alcoholic content.
```{r}
plot(brewbeer$IBU, brewbeer$ABV, main="Scatterplot - Bitterness of the beer Vs Alcoholic content",xlab="International Bitterness Units (IBU)", ylab=" Alcohol By Volume (ABV)", pch=19)
``` 

The scatter plot shows a positive relationship between IBU & ABV values.
There is a positive correlation between IBU & ABV values.

```{r}
#makeCodebook(brewbeer)
```